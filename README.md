# Python Copier Template

A Copier template for Python projects following modern best practices with Python 3.13+.

## Features

- **Modern Python**: Python 3.13+ with full type hints and strict type checking
- **Fast Package Manager**: Uses [uv](https://github.com/astral-sh/uv) for dependency management
- **Template Updates**: Supports updating existing projects with `copier update`
- **Custom Development CLI**: Plugin-based `./dev` script for common tasks
- **Comprehensive Testing**: pytest with custom fixtures and coverage support
- **Code Quality**: Integrated black, ruff, and mypy
- **Environment-Based Configuration**: python-dotenv for environment variables
- **Configurable Logging**: Supports both human-readable and JSON structured logging
- **License Options**: Apache 2.0 or Proprietary

## Prerequisites

- [uv](https://github.com/astral-sh/uv) - Fast Python package manager (used in generated projects)
- [Copier](https://copier.readthedocs.io/) - Template engine for project generation

## Quick Start

### Install Copier

```bash
# Using uv (recommended)
uv tool install --with jinja2-time copier
```

### Generate a New Project

```bash
# From GitHub
copier copy --trust gh:fernandoacorreia/python-cookiecutter your-project-name

# From local directory
copier copy --trust /path/to/python-cookiecutter your-project-name
```

You will be prompted for:
- **project_name**: Human-readable project name (e.g., "My Awesome Project")
- **project_slug**: URL/package-friendly name with hyphens (auto-generated, e.g., "my-awesome-project")
- **package_name**: Python module name with underscores (auto-generated, e.g., "my_awesome_project")
- **project_description**: One-line description of your project
- **author_name**: Your full name
- **author_email**: Your email address
- **python_version**: Python version constraint (default: ">=3.13,<3.14")
- **license**: License type (Apache-2.0 or Proprietary)

### Post-Generation Setup

The template includes post-generation tasks that automatically:
1. Initializes a Git repository
2. Creates CLAUDE.md symlink to AGENTS.md
3. Initializes virtual environment and installs dependencies (via `uv sync --dev`)
4. Initializes development tools (via `./dev init`)
5. Creates an initial commit

After generation, activate your environment and start coding:

```bash
cd your-project-name
source .venv/bin/activate
./dev --help
```

### Updating an Existing Project

To update a project generated from this template:

```bash
cd your-project-name
copier update
```

Copier will prompt you for any new questions and update your project while preserving your customizations.

### Answers File

Your project's `.copier-answers.yml` file tracks:
- Template source (`_src_path`)
- Template version (`_commit`)
- Your answers to template questions

Keep this file in version control to enable future updates.

## Generated Project Structure

```
your-project/
├── src/
│   └── your_project/          # Main package (underscores, not hyphens)
│       ├── __init__.py
│       ├── main.py            # Application entry point
│       └── py.typed           # PEP 561 type marker
│
├── tests/                     # Test suite
│   ├── __init__.py
│   ├── conftest.py           # pytest fixtures
│   ├── test_main.py          # Example tests
│   └── data/                 # Test data files
│       ├── README.md
│       └── sample.txt
│
├── scripts/                   # Development CLI
│   ├── dev.py                # Main CLI dispatcher
│   └── commands/             # Command modules
│       ├── __init__.py
│       ├── build.py          # Build distribution
│       ├── claude.py         # Claude CLI wrapper
│       ├── lint.py           # Run linters
│       ├── run.py            # Run application
│       ├── test.py           # Run tests
│       └── utils.py          # Shared utilities
│
├── .gitignore               # Git ignore rules
├── AGENTS.md                 # Claude Code instructions
├── CLAUDE.md -> AGENTS.md    # Symlink (created by hook)
├── dev                       # Development CLI entry point
├── example.env               # Environment variable template
├── LICENSE                   # Project license
├── pyproject.toml            # Project metadata and dependencies
├── README.md                 # Project documentation
└── uv.lock                   # Dependency lock file (generated by hook)
```

## Development Commands

The generated project includes a `./dev` script:

```bash
./dev --help    # Show all available commands
```

## Template Customization

### Modifying the Template

To customize this template for your needs:

1. Edit `copier.yml` to add/modify variables
2. Update template files in `template/`
3. Add `.jinja` suffix to files that contain template variables
4. Modify `_tasks` in `copier.yml` for custom post-generation tasks
5. Use Jinja2 syntax for dynamic content: `{{ variable_name }}`

### Example: Adding a New Variable

1. Add to `copier.yml`:
```yaml
your_new_variable:
  type: str
  help: Description of your variable
  default: default_value
```

2. Use in template files (file must have `.jinja` suffix):
```python
# In any template file with .jinja suffix
MY_CONFIG = "{{ your_new_variable }}"
```

## Architecture Highlights

### Custom Development CLI
- Plugin-based architecture for easy extensibility
- Each command is a separate module in `scripts/commands/`
- Unknown arguments are forwarded to underlying tools (pytest, claude)

### Test Infrastructure
- Custom pytest fixtures: `test_data_dir` and `temp_dir`
- Automatic cleanup of temporary directories
- Example tests demonstrating best practices

### Type Safety
- Strict mypy checking for production code (`src/`)
- Relaxed checking for tests (`tests/`)
- PEP 561 compliant with `py.typed` marker

### Logging Configuration
- Environment-based configuration via `.env`
- Two formats: pretty (human-readable) and JSON (structured)
- Custom `JSONFormatter` for production logging

## License

This template itself is licensed under the Apache License 2.0.
Projects generated from this template will use the license you select during project generation (Apache 2.0 or Proprietary).

## Resources

- [Copier Documentation](https://copier.readthedocs.io/)
- [Copier Template Creation Guide](https://copier.readthedocs.io/en/stable/creating/)
- [uv Documentation](https://github.com/astral-sh/uv)
- [Python Packaging Guide](https://packaging.python.org/)
- [pytest Documentation](https://docs.pytest.org/)